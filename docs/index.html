<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>CGBBâ™­ - The Sound Of The Future</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/2.4.3/webcomponents-bundle.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Material+Icons&display=block" rel="stylesheet"/>
  <script src="tone.js"></script>
</head>
<body>

<button id="play">play</button>
<button id="stop">stop</button>

<div>Right mouse click and "View Source" to see the code.</div>
<a href="sample.mp3">Listen to a pre-recorded mp3 version.</a>

  <script type="text/javascript">



    /// THIS IS THE CODE


    // INSTRUMENTS

    const pingPongDelay = new Tone.PingPongDelay({
      delayTime: "16n",
      feedback: 0.6,
      wet: 0.5
    }).toDestination(); // connect to speaker

    const instrument1 = new Tone.MembraneSynth({
      pitchDecay: 0.008,
      octaves: 2,
      envelope: {
        attack: 0.0006,
        decay: 0.5,
        sustain: 0
      }
    }).connect(pingPongDelay); // connect to pingPongDelay

     // drum
    const drum = new Tone.MembraneSynth().toDestination();
    const snare = new Tone.NoiseSynth().toDestination();

    // END INSTRUMENTS




    new Tone.Sequence(((time, pitch) => {
      drum.triggerAttack(pitch, time, Math.random()*0.5 + 0.6);
    }), [ "C1" ], "4n").start(0);

    const loop = new Tone.Loop((time) => {
      snare.triggerAttack(time);
    }, "2n").start('2m');

    new Tone.Sequence(((time, pitch) => {
      instrument1.triggerAttack(pitch, time, Math.random()*0.5 + 0.5); // this instrument is connected to pingPongDelay above
    }), ["C2", "G2", "B2", "D#2"], "8n").start('4m');  // Giorgio Moroder's notes




    // The beats per minute the song uses
    Tone.Transport.bpm.value = 120;

    /// END OF MUSIC CODE










    /// THIS IS FOR THE BUTTONS
    // browsers require interaction to play sound, in other words web pages cannot autoplay sounds, unless you click.

    const play = document.getElementById('play');
    const stop = document.getElementById('stop');

    play.addEventListener("click", function(){
      Tone.start();
      Tone.Transport.start();
    });

    stop.addEventListener("click", function(){
      Tone.Transport.stop();
      Tone.stop();

    });

  </script>


</body>
</html>
